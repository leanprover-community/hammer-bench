# hammer-bench Self-Tests

This directory contains expected outputs for the self-test suite.

## Running Self-Tests

```bash
hammer-bench selftest
```

## Generating Expected Outputs

Expected outputs are generated by running the self-test on a known-good setup:

1. Run the self-test without expected files:
   ```bash
   hammer-bench selftest
   ```

2. Copy the generated `messages.jsonl` files to `tests/expected/`:
   ```bash
   # Find the run directories
   ls ~/hammer-bench/runs/

   # Copy the messages files (adjust run IDs as needed)
   cp ~/hammer-bench/runs/YYYY-MM-DDTHH-MM-SS_omega_COMMIT/messages.jsonl \
      tests/expected/omega_quick_test.jsonl
   cp ~/hammer-bench/runs/YYYY-MM-DDTHH-MM-SS_decide_COMMIT/messages.jsonl \
      tests/expected/decide_quick_test.jsonl
   ```

3. Commit the expected files.

## Test Configuration

Tests are defined in `scripts/commands.py` in the `SELFTEST_TESTS` list:

```python
SELFTEST_TESTS = [
    # (preset, targets, description)
    ("omega", "quick_test", "omega on Logic.Basic"),
    ("decide", "quick_test", "decide on Logic.Basic"),
]
```

The expected output file name is derived from `{preset}_{targets}.jsonl`.

## Test Source

Tests run against a fixed commit specified by `SELFTEST_SOURCE`:

```python
SELFTEST_SOURCE = "leanprover-community/mathlib4-nightly-testing@hammer_measurements"
```

This should be updated once the upstream changes are merged.
